# 2. Nhập Phụ Cấp Chứng Chỉ
**Phiên bản:** v0.1  
**Ngày cập nhật:** 2025-01-25  
**Người biên soạn:** Chính  
**Người kiểm duyệt:** [PM/Leader Name]  
**Hệ thống:** Quản lý Nhân sự  

---

## Tổng quan
Màn hình nhập thông tin phụ cấp chứng chỉ mới (T_資格手当). Cung cấp chức năng nhập thông tin chi tiết phụ cấp chứng chỉ.

- **Endpoint màn hình:** `/qualification-allowances/create`
- **Màu nền:** Xanh lá (#10B981), vùng hiển thị chính màu trắng

## Wireframe
```
┌─────────────────────────────────────────────────────────┐
│ 💰 Nhập Phụ Cấp Chứng Chỉ [Tạo mới] [←Quay lại]        │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Tên: [________________] *Bắt buộc                  │ │
│ │ Cấp độ: [Cơ bản ▼] *Bắt buộc                      │ │
│ │ Loại: [Quốc gia ▼] *Bắt buộc                       │ │
│ │ Số tiền: [¥________] *Bắt buộc                      │ │
│ │ Ghi chú: [________________] *Bắt buộc              │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ [💾Lưu tạm] [✅Đăng ký] [❌Hủy]                       │
└─────────────────────────────────────────────────────────┘
```

## Endpoint API
| Tên API | Endpoint | Mục đích |
|---------|----------|----------|
| Tạo phụ cấp chứng chỉ | `POST /api/v1/qualifications/allowances` | Tạo phụ cấp chứng chỉ mới |
| Cập nhật phụ cấp chứng chỉ | `PUT /api/v1/qualifications/allowances/{id}` | Cập nhật phụ cấp chứng chỉ |
| Lấy phụ cấp chứng chỉ | `GET /api/v1/qualifications/allowances/{id}` | Lấy thông tin phụ cấp chứng chỉ |

---

## Hiển thị ban đầu
### Chế độ hiển thị
| Chế độ | Tham số | Mô tả |
|:--|:--|:--|
| Tạo mới | mode=create | Chế độ tạo mới (tất cả trường có thể nhập) |
| Chỉnh sửa | mode=edit&id={id} | Chế độ chỉnh sửa (tải dữ liệu hiện có) |
| Xem | mode=view&id={id} | Chế độ xem (tất cả trường chỉ đọc) |

### Xử lý chung
1. Xác định chế độ khi khởi tạo màn hình
2. Nếu chế độ chỉnh sửa/xem: lấy dữ liệu theo ID được chỉ định
3. Đặt dữ liệu vào form
4. Nếu chế độ xem: đặt tất cả trường thành chỉ đọc

---

## Mô tả các trường

### 1. Tên phụ cấp chứng chỉ
| Trường | Giá trị |
|:--|:--|
| Nhãn | Tên |
| Kiểu | String |
| Bắt buộc | ○ |
| Số ký tự tối đa | 100 |
| Màu nền | #FFFFCC (trường bắt buộc) |
| Ghi chú | Tên của phụ cấp chứng chỉ |

#### Xác thực
- Kiểm tra bắt buộc: Nếu trống hiển thị "Tên là bắt buộc."
- Kiểm tra độ dài: Nếu vượt quá 100 ký tự hiển thị "Tên không được vượt quá 100 ký tự."

### 2. Cấp độ
| Trường | Giá trị |
|:--|:--|
| Nhãn | Cấp độ |
| Kiểu | Dropdown |
| Bắt buộc | ○ |
| Màu nền | #FFFFCC (trường bắt buộc) |
| Ghi chú | Cấp độ của phụ cấp chứng chỉ |

#### Tùy chọn cấp độ
- Cơ bản
- Ứng dụng  
- Chuyên môn

#### Xác thực
- Kiểm tra bắt buộc: Nếu không chọn hiển thị "Cấp độ là bắt buộc."

### 3. Loại
| Trường | Giá trị |
|:--|:--|
| Nhãn | Loại |
| Kiểu | Dropdown |
| Bắt buộc | ○ |
| Màu nền | #FFFFCC (trường bắt buộc) |
| Ghi chú | Loại phụ cấp chứng chỉ |

#### Tùy chọn loại
- Chứng chỉ Quốc gia
- Chứng chỉ Tư nhân
- Chứng chỉ Quốc tế

#### Xác thực
- Kiểm tra bắt buộc: Nếu không chọn hiển thị "Loại là bắt buộc."

### 4. Số tiền
| Trường | Giá trị |
|:--|:--|
| Nhãn | Số tiền |
| Kiểu | Decimal |
| Bắt buộc | ○ |
| Màu nền | #FFFFCC (trường bắt buộc) |
| Ghi chú | Số tiền phụ cấp chứng chỉ |

#### Định dạng nhập số tiền
- Ký hiệu tiền tệ: ¥ (hiển thị tự động)
- Phân cách hàng nghìn: Dấu phẩy (ví dụ: ¥15,000)
- Số thập phân: Chỉ cho phép nhập số nguyên
- Phạm vi nhập: 0 < số tiền ≤ 999,999,999

#### Xác thực
- Kiểm tra bắt buộc: Nếu trống hiển thị "Số tiền là bắt buộc."
- Kiểm tra số: Nếu không phải số hiển thị "Số tiền phải là số."
- Kiểm tra phạm vi: Nếu ≤ 0 hiển thị "Số tiền phải lớn hơn 0."
- Kiểm tra phạm vi: Nếu > 999,999,999 hiển thị "Số tiền không được vượt quá 999,999,999."

### 5. Ghi chú
| Trường | Giá trị |
|:--|:--|
| Nhãn | Ghi chú |
| Kiểu | String |
| Bắt buộc | ○ |
| Số ký tự tối đa | 200 |
| Màu nền | #FFFFCC (trường bắt buộc) |
| Ghi chú | Ghi chú về phụ cấp chứng chỉ |

#### Xác thực
- Kiểm tra bắt buộc: Nếu trống hiển thị "Ghi chú là bắt buộc."
- Kiểm tra độ dài: Nếu vượt quá 200 ký tự hiển thị "Ghi chú không được vượt quá 200 ký tự."

---

## Xử lý lưu tạm
### Nút lưu tạm
- Lưu dữ liệu mà không thực hiện xác thực
- Khi lưu thành công: Hiển thị thông báo "Đã lưu tạm."
- Khi lưu thất bại: Hiển thị thông báo lỗi

### API lưu tạm
**API:** `POST /api/v1/qualifications/allowances`

#### Khi tạo mới
```json
{
  "name": "Kỹ sư Thông tin Cơ bản",
  "grade": "Cơ bản",
  "type": "Chứng chỉ Quốc gia",
  "amount": 5000.00,
  "remarks": "Chứng chỉ IT cơ bản"
}
```

#### Khi chỉnh sửa
```json
{
  "qualificationId": 123,
  "name": "Kỹ sư Thông tin Cơ bản",
  "grade": "Cơ bản",
  "type": "Chứng chỉ Quốc gia",
  "amount": 5000.00,
  "remarks": "Chứng chỉ IT cơ bản"
}
```

---

## Xử lý đăng ký
### Nút đăng ký
1. Thực hiện xác thực tất cả các trường
2. Nếu có lỗi xác thực: Hiển thị thông báo lỗi, kết thúc xử lý
3. Khi xác thực thành công: Hiển thị dialog xác nhận đăng ký

### Dialog xác nhận đăng ký
#### Nội dung dialog
- Tiêu đề: "Xác nhận đăng ký"
- Thông báo: "Bạn có muốn đăng ký phụ cấp chứng chỉ này không?"
- Nút: [Hủy] [Đăng ký]

#### Xử lý đăng ký
1. Gọi API (giống như lưu tạm)
2. Khi đăng ký thành công: Hiển thị thông báo thành công, chuyển đến màn hình danh sách
3. Khi đăng ký thất bại: Hiển thị thông báo lỗi

---

## Các kiểm tra

### 1. Kiểm tra trường bắt buộc
Hiển thị thông báo lỗi cho trường bắt buộc nếu trống

### 2. Kiểm tra độ dài
Hiển thị thông báo lỗi nếu vượt quá số ký tự tối đa

### 3. Kiểm tra số tiền
- Kiểm tra định dạng số tiền
- Kiểm tra phạm vi giá trị

### 4. Kiểm tra trùng lặp
- Kiểm tra tên phụ cấp chứng chỉ trùng lặp
- Kiểm tra tổ hợp tên + cấp độ trùng lặp

---

## Thông báo hoàn thành

### Thông báo thành công
- Lưu tạm hoàn thành: "Đã lưu tạm."
- Đăng ký hoàn thành: "Đã đăng ký phụ cấp chứng chỉ."

### Thông báo lỗi
- Lỗi xác thực: Hiển thị thông báo lỗi cho trường tương ứng
- Lỗi API: "Không thể lưu dữ liệu."
- Lỗi trùng lặp: "Tên phụ cấp chứng chỉ này đã tồn tại."

---

## Điều hướng

### Nút quay lại
- Quay về màn hình danh sách
- Nếu có thay đổi chưa lưu: Hiển thị dialog xác nhận

### Nút hủy
- Quay về màn hình danh sách
- Nếu có thay đổi chưa lưu: Hiển thị dialog xác nhận

---

## Xử lý lỗi

### Lỗi API
- Lỗi kết nối: "Không thể kết nối đến máy chủ."
- Lỗi xác thực: "Cần đăng nhập."
- Lỗi quyền: "Không có quyền thực hiện thao tác này."

### Lỗi xác thực
- Lỗi trường bắt buộc: Thay đổi màu nền trường và hiển thị thông báo lỗi
- Lỗi độ dài: Hiển thị thông báo lỗi cho trường tương ứng
- Lỗi trùng lặp: Hiển thị thông báo lỗi cho trường tương ứng

---

## Xử lý lấy dữ liệu

### Lấy dữ liệu khi chỉnh sửa/xem
**API:** `GET /api/v1/qualifications/allowances/{id}`

#### Tham số yêu cầu
**GET** `/api/v1/qualifications/allowances/{id}`

#### Tham số đường dẫn
| Tên tham số | Kiểu | Bắt buộc | Ghi chú |
|:--|:--|:--|:--|
| id | Int | ○ | ID phụ cấp chứng chỉ cần lấy |

#### Xử lý phản hồi
- Khi lấy thành công: Đặt dữ liệu vào form
- Khi lấy thất bại: Hiển thị thông báo lỗi, quay về màn hình danh sách

---

*Tài liệu này được sử dụng cho phát triển và bảo trì Hệ thống Quản lý Nhân sự*
