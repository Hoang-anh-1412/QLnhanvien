# 3.資格手当入力

## ワイヤーフレーム
```
┌─────────────────────────────────────────────────────────┐
│ 💰 資格手当入力 [新規作成] [←戻る]                      │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 名称: [________________] *必須                      │ │
│ │ 等級: [________________] *必須                     │ │
│ │ 種類: [________________] *必須                     │ │
│ │ 金額: [¥________] *必須                            │ │
│ │ 備考: [________________] *必須                     │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ [✅登録] [❌キャンセル]                                │
└─────────────────────────────────────────────────────────┘
```

## 概要
資格手当（Qualification Allowance）の新規作成・編集・参照画面。資格手当情報の入力、登録機能を提供する。金額入力には通貨形式のバリデーションを適用。

## エンドポイント
`/api/v1/qualification-allowances` (新規作成)
`/api/v1/qualification-allowances/{id}` (編集・参照)

## 画面背景色
「ライトモード」及び「ダークモード」をボタン切替できるようにする

## 初期表示
### 表示モード
| モード | パラメータ | 説明 |
|:--|:--|:--|
| 新規作成 | mode=create | 新規作成モード（全項目入力可能） |
| 編集 | mode=edit&id={id} | 編集モード（既存データを読み込み） |
| 参照 | mode=view&id={id} | 参照モード（全項目読み取り専用） |

### 共通処理
1. 画面初期化時にモード判定
2. 編集・参照モードの場合、指定IDのデータを取得
3. 取得データをフォームに設定
4. 参照モードの場合、全項目を読み取り専用に設定

## 各項目の説明

### 1. 名称
| 項目 | 値 |
|:--|:--|
| ラベル | 名称 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 50 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 資格手当の名称を入力 |

#### バリデーション
- 必須チェック: 未入力の場合「名称は必須です。」を表示
- 文字数チェック: 50文字を超える場合「名称は50文字以内で入力してください。」を表示

### 2. 等級
| 項目 | 値 |
|:--|:--|
| ラベル | 等級 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 20 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 資格の等級を入力 |

#### バリデーション
- 必須チェック: 未入力の場合「等級は必須です。」を表示
- 文字数チェック: 20文字を超える場合「等級は20文字以内で入力してください。」を表示

### 3. 種類
| 項目 | 値 |
|:--|:--|
| ラベル | 種類 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 20 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 資格の種類を入力 |

#### バリデーション
- 必須チェック: 未入力の場合「種類は必須です。」を表示
- 文字数チェック: 20文字を超える場合「種類は20文字以内で入力してください。」を表示

### 4. 金額
| 項目 | 値 |
|:--|:--|
| ラベル | 金額 |
| 型 | Decimal |
| 必須 | ○ |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 資格手当の金額を入力（通貨形式） |

#### 金額入力形式
- 通貨記号: ¥（自動表示）
- 桁区切り: カンマ区切り（例: ¥15,000）
- 小数点: 整数のみ入力可能
- 入力範囲: 0 < 金額 ≤ 999,999,999

#### バリデーション
- 必須チェック: 未入力の場合「金額は必須です。」を表示
- 数値チェック: 数値以外の場合「金額は数値で入力してください。」を表示
- 範囲チェック: 0以下の場合「金額は0より大きい値を入力してください。」を表示
- 範囲チェック: 999,999,999を超える場合「金額は999,999,999以下で入力してください。」を表示

### 5. 備考
| 項目 | 値 |
|:--|:--|
| ラベル | 備考 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 100 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 資格手当に関する備考を入力 |

#### バリデーション
- 必須チェック: 未入力の場合「備考は必須です。」を表示
- 文字数チェック: 100文字を超える場合「備考は100文字以内で入力してください。」を表示


## 登録処理
### 登録ボタン
1. 全項目のバリデーション実行
2. バリデーションエラーがある場合: エラーメッセージ表示、処理終了
3. バリデーション成功時: 登録確認モーダル表示

### 登録確認モーダル
#### モーダル内容
- タイトル: "登録確認"
- メッセージ: "資格手当を登録しますか？"
- ボタン: [キャンセル] [登録実行]

#### 登録実行処理
1. API呼び出し（[3.資格手当API](./API/3.資格手当.md)の**POST** `/api/v1/qualification-allowances`または**PUT** `/api/v1/qualification-allowances/{id}`エンドポイント）
2. 登録成功時: 成功メッセージ表示、一覧画面に遷移
3. 登録失敗時: エラーメッセージ表示


## 完了メッセージ

### 成功メッセージ
- 登録完了: "資格手当を登録しました。"

### エラーメッセージ
- バリデーションエラー: 該当項目にエラーメッセージ表示
- API通信エラー: "データの保存に失敗しました。"
- 数値エラー: "金額は正しい数値で入力してください。"


## エラーハンドリング

### API エラー
- 通信エラー: "データの取得に失敗しました。"
- 認証エラー: "ログインが必要です。"
- 権限エラー: "この操作を実行する権限がありません。"

### バリデーションエラー
- 必須項目エラー: 該当項目の背景色を変更し、エラーメッセージ表示
- 文字数エラー: 該当項目にエラーメッセージ表示
- 数値エラー: 該当項目にエラーメッセージ表示

## データ取得処理

### 編集・参照モード時のデータ取得
[3.資格手当API](./API/3.資格手当.md)の**GET** `/api/v1/qualification-allowances/{id}`エンドポイントを使用

#### リクエストパラメータ
**GET** `/api/v1/qualification-allowances/{id}`

#### パスパラメータ
| パラメータ名 | 型 | 必須 | 備考 |
|:--|:--|:--|:--|
| id | Int | ○ | 取得対象の資格手当ID |

#### レスポンス処理
- 取得成功時: フォームにデータを設定
- 取得失敗時: エラーメッセージ表示、一覧画面に戻る

## 通貨入力の特殊処理

### 金額入力フィールド
- 入力時に自動で通貨記号（¥）を表示
- 数値入力時に自動でカンマ区切りを適用
- 小数点以下の入力は無効化
- 負の値の入力は無効化

### 金額表示形式
- 表示時: ¥15,000 形式
- 入力時: 数値のみ入力可能
- 保存時: 数値のみAPIに送信
