# 社員名簿登録画面仕様書
**バージョン:** v0.1  
**最終更新:** 2025-10-25  
**作成者:** Chính  
**レビュー担当:** [PM/Leader Name]  
**システム:** 人事管理  

---

## 1. 概要
**社員名簿登録**画面は、個人情報、住所、資格、溶接免許を含む社員の詳細情報を入力、編集、管理するために使用されます。

- **画面エンドポイント:** `/employee/registration`
- **背景色:** 紫 (#8B5CF6)、メイン表示エリア白

## ワイヤーフレーム
![Employee Registration UI](Employee_Registration_UI.png)

---

## 画面構成

### 1. 個人情報 (個人情報)

#### 1.1. 基本情報
- **社員コード (社員コード)**
  - **タイプ:** テキスト入力
  - **必須:** はい
  - **説明:** 社員の一意識別子
  - **DBマッピング:** `T_社員マスタ.社員コード`

- **統括部門 (統括部門)**
  - **タイプ:** ドロップダウン
  - **必須:** はい
  - **説明:** 高レベル管理部門
  - **DBマッピング:** `T_統括部門.統括部門` via `T_社員マスタ.部門名`

- **部署名 (部署名)**
  - **タイプ:** ドロップダウン
  - **必須:** はい
  - **説明:** 具体的な部署名
  - **DBマッピング:** `T_部署名.部署名` via `T_社員マスタ.部署名`

- **氏名 (氏名)**
  - **タイプ:** テキスト入力
  - **必須:** はい
  - **説明:** 社員のフルネーム
  - **DBマッピング:** `T_社員マスタ.氏名`

- **ふりがな (ふりがな)**
  - **タイプ:** テキスト入力
  - **必須:** いいえ
  - **説明:** ひらがな/カタカナでの社員名
  - **DBマッピング:** `T_社員マスタ.かな氏名`

- **性別 (性別)**
  - **タイプ:** ラジオボタン
  - **オプション:** 男 (男性), 女 (女性)
  - **必須:** はい
  - **DBマッピング:** `T_社員マスタ.性別`

- **生年月日 (生年月日)**
  - **タイプ:** 日付ピッカー
  - **必須:** はい
  - **説明:** 社員の生年月日
  - **DBマッピング:** `T_社員マスタ.生年月日`

- **入社年月日 (入社年月日)**
  - **タイプ:** 日付ピッカー
  - **必須:** はい
  - **説明:** 社員の入社日
  - **DBマッピング:** `T_社員マスタ.入社年月日`

- **退職年月日 (退職年月日)**
  - **タイプ:** 日付ピッカー
  - **必須:** いいえ
  - **説明:** 社員の退職日
  - **DBマッピング:** `T_社員マスタ.退職年月日`

- **結婚記念日 (結婚記念日)**
  - **タイプ:** 日付ピッカー
  - **必須:** いいえ
  - **説明:** 社員の結婚記念日
  - **DBマッピング:** `T_社員マスタ.結婚記念日`

#### 1.2. 現住所 (現住所)
- **郵便番号 (郵便番号)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.郵便番号1`

- **住所 (住所)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.住所1`

- **ビル名 (ビル名)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.ビル名1`

- **TEL (TEL)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.TEL1`

- **TEL(携帯用) (TEL(携帯用))**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.TEL携帯用`

#### 1.3. 実家 (実家)
- **郵便番号 (郵便番号)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.郵便番号2`

- **住所 (住所)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.住所2`

- **ビル名 (ビル名)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.ビル名2`

- **TEL (TEL)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_社員マスタ.TEL2`

#### 1.4. 備考 (備考)
- **タイプ:** テキストエリア
- **説明:** 一般的な備考フィールド
- **DBマッピング:** `T_社員マスタ.備考`

---

### 2. 資格 (資格)

#### 2.1. 資格管理テーブル
**テーブル構造:**
- **名称 (資格名)**
  - **タイプ:** ドロップダウン
  - **DBマッピング:** `T_資格手当.名称` via `T_資格.資格ID`

- **等級 (等級)**
  - **タイプ:** テキスト表示
  - **DBマッピング:** `T_資格手当.等級`

- **種類 (種類)**
  - **タイプ:** テキスト表示
  - **DBマッピング:** `T_資格手当.種類`

- **金額 (手当金額)**
  - **タイプ:** 数値表示
  - **DBマッピング:** `T_資格手当.金額`

- **該 (適用)**
  - **タイプ:** チェックボックス
  - **DBマッピング:** `T_資格.チェック`

- **番号 (証明書番号)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_資格.番号`

- **取得日 (取得日)**
  - **タイプ:** 日付ピッカー
  - **DBマッピング:** `T_資格.取得日`

#### 2.2. テーブル機能
- **新規行追加:** "+"ボタンで新しい資格を追加
- **行削除:** "-"ボタンで資格を削除
- **自動計算:** 変更時に手当合計を更新

---

### 3. 溶接免許 (溶接免許)

#### 3.1. 溶接免許管理テーブル
**テーブル構造:**
- **証明書 (証明書)**
  - **タイプ:** ドロップダウン
  - **DBマッピング:** `T_溶接免許.証明書`

- **級区分 (級区分)**
  - **タイプ:** テキスト表示
  - **DBマッピング:** `T_溶接免許.級区分`

- **合格資格 (合格資格)**
  - **タイプ:** テキスト表示
  - **DBマッピング:** `T_溶接免許.合格資格`

- **金額 (手当金額)**
  - **タイプ:** 数値表示
  - **DBマッピング:** `T_溶接免許.金額`

- **該 (適用)**
  - **タイプ:** チェックボックス
  - **DBマッピング:** `T_溶接免許.チェック`

- **証明書番号 (証明書番号)**
  - **タイプ:** テキスト入力
  - **DBマッピング:** `T_溶接免許.証明書番号`

- **登録 (登録日)**
  - **タイプ:** 日付ピッカー
  - **DBマッピング:** `T_溶接免許.登録年月日`

#### 3.2. テーブル機能
- **新規行追加:** "+"ボタンで新しい免許を追加
- **行削除:** "-"ボタンで免許を削除
- **自動計算:** 変更時に手当合計を更新

---

### 4. 手当合計 (右側)

#### 4.1. 手当表示
- **通常資格手当合計 (通常資格手当合計)**
  - **タイプ:** 読み取り専用フィールド
  - **デフォルト値:** ¥0
  - **説明:** 通常資格からの手当合計

- **全資格手当合計 (全資格手当合計)**
  - **タイプ:** 読み取り専用フィールド
  - **デフォルト値:** ¥0
  - **説明:** すべての資格タイプからの手当合計

- **溶接免許手当合計 (溶接免許手当合計)**
  - **タイプ:** 読み取り専用フィールド
  - **デフォルト値:** ¥0
  - **説明:** 溶接免許からの手当合計

#### 4.2. 機能ボタン
- **計算 (計算)**
  - **タイプ:** ボタン
  - **機能:** すべての手当合計を再計算
  - **トリガー:** ボタン押下時またはデータ変更時

---

## 一般機能

### 1. ナビゲーションボタン
- **保存 (保存)**
  - **機能:** 社員情報を保存
  - **バリデーション:** 保存前に必須データをチェック

- **キャンセル (キャンセル)**
  - **機能:** 操作をキャンセルして前の画面に戻る

- **削除 (削除)**
  - **タイプ:** ゴミ箱アイコン
  - **機能:** 社員を削除（確認が必要）

### 2. バリデーション
- **必須データ:** 必須フィールドをチェック
- **データ形式:** 日付形式、電話番号をバリデーション
- **一意性:** 社員コードの重複をチェック

### 3. 自動計算
- **資格手当:** 資格の追加/編集/削除時に自動計算
- **溶接免許手当:** 免許の追加/編集/削除時に自動計算
- **手当合計:** 最終手当合計を更新

---

## APIエンドポイント

### 1. 社員情報取得
- **API Call:** `GET /api/v1/employees/{employeeCode}`
- **Response Data Type:**
```typescript
interface EmployeeDetail {
  employeeCode: string;
  fullName: string;
  kanaName?: string;
  divisionName: string;
  departmentName: string;
  gender: string;
  dateOfBirth: string;
  hireDate: string;
  resignationDate?: string;
  weddingAnniversary?: string;
  currentAddress?: {
    postalCode?: string;
    address?: string;
    buildingName?: string;
    phone?: string;
    mobilePhone?: string;
  };
  familyAddress?: {
    postalCode?: string;
    address?: string;
    buildingName?: string;
    phone?: string;
  };
  remarks?: string;
  qualifications: Qualification[];
  weldingLicenses: WeldingLicense[];
}
```

### 2. 社員情報保存
- **API Call:** `PUT /api/v1/employees/{employeeCode}`
- **Request Data Type:**
```typescript
interface EmployeeUpdateRequest {
  fullName: string;
  kanaName?: string;
  divisionName: string;
  departmentName: string;
  gender: string;
  dateOfBirth: string;
  hireDate: string;
  resignationDate?: string;
  weddingAnniversary?: string;
  currentAddress?: {
    postalCode?: string;
    address?: string;
    buildingName?: string;
    phone?: string;
    mobilePhone?: string;
  };
  familyAddress?: {
    postalCode?: string;
    address?: string;
    buildingName?: string;
    phone?: string;
  };
  remarks?: string;
  qualifications: Qualification[];
  weldingLicenses: WeldingLicense[];
}
```

### 3. 部署リスト取得
- **API Call:** `GET /api/v1/departments`
- **Response Data Type:**
```typescript
interface Department {
  divisionId: number;
  divisionName: string;
  departmentId: string;
  departmentName: string;
}
```

### 4. 資格リスト取得
- **API Call:** `GET /api/v1/qualifications`
- **Response Data Type:**
```typescript
interface QualificationMaster {
  qualificationId: number;
  name: string;
  grade: string;
  type: string;
  allowanceAmount: number;
}
```

---

## 処理フロー

### 1. 新規社員作成
1. 基本個人情報を入力
2. ドロップダウンから部署を選択
3. 住所を入力（必要に応じて）
4. 資格を追加（ある場合）
5. 溶接免許を追加（ある場合）
6. 「保存」を押して新規社員を作成

### 2. 社員編集
1. 現在の社員情報を読み込み
2. 必要なフィールドを編集
3. 資格/免許を更新
4. 「保存」を押して更新

### 3. 社員削除
1. ゴミ箱アイコンを押す
2. 削除を確認
3. 削除を実行（ソフト削除）

---

## 技術ノート

### 1. 依存関係
- CRUD操作のAPIエンドポイントが必要
- 部署と資格リストを取得するAPIが必要
- データフィールドのバリデーションルールが必要

### 2. パフォーマンス
- ドロップダウンデータの遅延読み込み
- バリデーションのデバウンス
- UIの楽観的更新

### 3. エラーハンドリング
- バリデーションエラーをインライン表示
- 成功/エラーのトースト通知
- API呼び出しのリトライメカニズム

---
