# 作業服注文登録画面仕様書
**バージョン:** v0.1  
**最終更新:** 2025-10-25  
**作成者:** Chính  
**レビュー担当:** [PM/Leader Name]  
**システム:** 人事管理  

---

## 1. 概要
社員の作業服注文登録画面（作業服注文登録）。  
詳細な作業服注文の作成、編集、管理機能を提供します。

- **画面エンドポイント:** `/work-uniform/order-registration`
- **背景色:** 薄緑 (#90EE90)、赤い枠

## ワイヤーフレーム
![作業服注文登録画面](Work_Uniform_Order_Registration_UI.png)

---

## 2. APIエンドポイント
| API名 | エンドポイント | 目的 |
|-------|----------------|------|
| 作業服注文 | `/api/v1/work-uniform-orders` | 作業服注文のCRUD |
| 社員マスタ | `/api/v1/employees` | 社員情報取得 |
| 部署 | `/api/v1/departments` | 部署リスト取得 |
| 品目マスタ | `/api/v1/items` | 作業服商品リスト取得 |

---

## 3. 初期表示
1. **社員情報:** すべてのフィールドが空
2. **注文情報:** 注文日 = 現在日、納入日は空
3. **注文明細テーブル:** 新規追加用の空行（*付き）
4. **数量サマリー:** すべて = 0
5. **印刷オプション:** 未選択

---

## 4. 画面構成

### 4.1. 上部セクション - 部署選択
- **統括部門 (統括部門)**
  - **タイプ:** ドロップダウン
  - **目的:** 下位部署をフィルタ
  - **API:** `GET /api/v1/departments/divisions`

- **部署名 (部署名)**
  - **タイプ:** ドロップダウン
  - **目的:** 具体的な部署を選択
  - **API:** `GET /api/v1/departments/by-division/{divisionId}`

### 4.2. 左セクション - 社員・注文情報

#### 4.2.1. 社員情報
- **社員コード (社員コード)**
  - **タイプ:** オートコンプリート付きドロップダウン
  - **必須:** はい
  - **API:** `GET /api/v1/employees?search={code}`

- **統括部門 (統括部門)**
  - **タイプ:** テキスト入力（読み取り専用）
  - **説明:** 社員選択時に自動入力

- **部署名 (部署名)**
  - **タイプ:** テキスト入力（読み取り専用）
  - **説明:** 社員選択時に自動入力

- **氏名 (氏名)**
  - **タイプ:** テキスト入力（読み取り専用）
  - **説明:** 社員選択時に自動入力

- **かな氏名 (かな氏名)**
  - **タイプ:** テキスト入力（読み取り専用）
  - **説明:** 社員選択時に自動入力

#### 4.2.2. 注文情報
- **注文日 (注文日)**
  - **タイプ:** 日付ピッカー
  - **必須:** はい
  - **デフォルト:** 現在日

- **納入日 (納入日)**
  - **タイプ:** 日付ピッカー
  - **必須:** いいえ
  - **バリデーション:** 注文日より後の日付である必要があります

### 4.3. 右セクション - 印刷オプション
- **印刷対象 (印刷対象)**
  - **タイプ:** チェックボックス
  - **説明:** 注文を印刷対象としてマーク

- **印刷 (印刷)**
  - **タイプ:** ボタン（赤色）
  - **説明:** 作業服注文を印刷
  - **バリデーション:** 少なくとも1つの商品が必要

### 4.4. 中央セクション - 注文明細テーブル

#### 4.4.1. テーブル構造
- **品番 (商品コード)**
  - **タイプ:** ドロップダウン
  - **必須:** はい
  - **API:** `GET /api/v1/items`

- **項目 (商品名)**
  - **タイプ:** テキスト表示
  - **説明:** 商品コード選択時に自動入力

- **仕様 (仕様)**
  - **タイプ:** テキスト表示
  - **説明:** 商品コード選択時に自動入力

- **サイズ (サイズ)**
  - **タイプ:** ドロップダウン
  - **必須:** はい
  - **説明:** 選択した商品の利用可能サイズ

- **数量 (数量)**
  - **タイプ:** 数値入力
  - **必須:** はい
  - **デフォルト:** 0
  - **バリデーション:** > 0

- **単位 (単位)**
  - **タイプ:** テキスト表示
  - **説明:** 商品コード選択時に自動入力

#### 4.4.2. テーブル機能
- **新規行追加:** 行の先頭に（*）
- **行削除:** 行の末尾のゴミ箱アイコン
- **自動合計計算:** 数量サマリーを更新

### 4.5. 下部セクション - 数量サマリー

#### 4.5.1. 上着
- **作業服(上) (作業服上)**
  - **タイプ:** ドロップダウン
  - **説明:** 上着の種類を選択

- **枚数(上) (上着数量)**
  - **タイプ:** 数値入力（読み取り専用）
  - **説明:** 明細テーブルから自動計算

#### 4.5.2. 下着
- **作業服(下) (作業服下)**
  - **タイプ:** ドロップダウン
  - **説明:** 下着の種類を選択

- **枚数(下) (下着数量)**
  - **タイプ:** 数値入力（読み取り専用）
  - **説明:** 明細テーブルから自動計算

### 4.6. 最下部 - 制御ボタン
- **削除 (ゴミ箱アイコン)**
  - **タイプ:** アイコンボタン
  - **説明:** 現在の注文を削除
  - **バリデーション:** 削除前に確認

- **保存 (保存アイコン)**
  - **タイプ:** アイコンボタン
  - **説明:** 作業服注文を保存
  - **バリデーション:** 必須データをチェック

---

## 5. 処理フロー

### 5.1. 新規注文作成
1. 統括部門を選択 → 下位部署リストを更新
2. 下位部署を選択 → 社員リストを更新
3. 社員を選択 → 社員情報を自動入力
4. 納入日を入力（オプション）
5. 明細テーブルに商品を追加
6. 「保存」をクリックして注文を作成

### 5.2. 注文編集
1. 現在の注文情報を読み込み
2. 必要なフィールドを編集
3. 明細テーブルで商品を追加/編集/削除
4. 「保存」をクリックして更新

### 5.3. 注文印刷
1. 「印刷対象」チェックボックスをチェック
2. 「印刷」ボタン（赤）をクリック
3. システムがPDFを生成して表示

---

## 6. 詳細APIエンドポイント

### 6.1. 社員情報取得
- **API Call:** `GET /api/v1/employees/{employeeCode}`
- **Response Data Type:**
```typescript
interface EmployeeInfo {
  employeeCode: string;
  fullName: string;
  kanaName: string;
  divisionName: string;
  departmentName: string;
}
```

### 6.2. 商品リスト取得
- **API Call:** `GET /api/v1/items`
- **Response Data Type:**
```typescript
interface Item {
  itemCode: string;
  itemName: string;
  specifications: string;
  availableSizes: string[];
  unit: string;
  unitPrice: number;
}
```

### 6.3. 作業服注文作成
- **API Call:** `POST /api/v1/work-uniform-orders`
- **Request Data Type:**
```typescript
interface CreateWorkUniformOrderRequest {
  employeeCode: string;
  orderDate: string;
  deliveryDate?: string;
  items: {
    itemCode: string;
    size: string;
    quantity: number;
  }[];
  isPrintTarget: boolean;
}
```

### 6.4. 作業服注文更新
- **API Call:** `PUT /api/v1/work-uniform-orders/{orderCode}`
- **Request Data Type:**
```typescript
interface UpdateWorkUniformOrderRequest {
  deliveryDate?: string;
  items: {
    itemCode: string;
    size: string;
    quantity: number;
  }[];
  isPrintTarget: boolean;
}
```

---

## 7. バリデーションルール

### 7.1. 必須データ
- 社員コード
- 注文日
- 明細テーブルに少なくとも1つの商品
- 各商品には商品コード、サイズ、数量 > 0が必要

### 7.2. バリデーションロジック
- 納入日は注文日より後の日付である必要があります
- 数量は > 0 である必要があります
- 商品コードはシステムに存在する必要があります
- サイズは選択した商品で利用可能である必要があります

---

## 8. エラーハンドリング
| エラーコード | 原因 | 表示 |
|-------------|------|------|
| 400 | 無効なデータ | "入力データが無効です" |
| 404 | 社員が見つからない | "社員が見つかりません" |
| 404 | 商品が見つからない | "商品が見つかりません" |
| 500 | システムエラー | "システムエラー。再試行してください" |

---

## 9. レスポンシブデザイン・アクセシビリティ
- 画面幅に応じて自動スケール
- キーボードナビゲーション対応
- 色覚障害者でも区別できる色使い
- 長い明細テーブル用のスクロールバー

---

## 10. パフォーマンス最適化・キャッシュ
- 部署リストをキャッシュ（変更頻度低）
- 商品リストを1時間キャッシュ
- 社員リストの遅延読み込み
- オートコンプリート用デバウンス

---

## 11. 環境・技術要件
| 項目 | 値 |
|------|-----|
| フレームワーク | React + TypeScript |
| CSS | TailwindCSS |
| 対応ブラウザ | Chrome 120+, Edge 120+ |
| 言語 | 日本語 (UTF-8) |

---

## 12. テスト・検証
| 項目 | 条件 | 期待結果 |
|------|------|----------|
| 新規注文作成 | 完全な必須情報を入力 | 正常に作成 |
| 日付バリデーション | 納入日が注文日より前 | バリデーションエラーを表示 |
| 商品追加 | 商品コードとサイズを選択 | 商品情報を自動入力 |
| 合計計算 | 商品を追加/編集/削除 | 数量サマリーを自動更新 |

---

*この文書は人事管理システム（HR Management System）の開発・保守に使用されます*
