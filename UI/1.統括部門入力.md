# 1.統括部門入力

## ワイヤーフレーム
```
┌─────────────────────────────────────────────────────────┐
│ 🏢 統括部門入力 [新規作成] [←戻る]                      │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 部門名: [________________] *必須                    │ │
│ │ Field1: [________________] *必須                    │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ [💾一時保存] [✅登録] [❌キャンセル]                    │
└─────────────────────────────────────────────────────────┘
```

## 概要
統括部門（Division）の新規作成・編集・参照画面。部門情報の入力、一時保存、登録機能を提供する。

## エンドポイント
`/divisions/create` (新規作成)
`/divisions/edit/{id}` (編集)
`/divisions/view/{id}` (参照)

## 画面背景色
「ライトモード」及び「ダークモード」をボタン切替できるようにする

## 初期表示
### 表示モード
| モード | パラメータ | 説明 |
|:--|:--|:--|
| 新規作成 | mode=create | 新規作成モード（全項目入力可能） |
| 編集 | mode=edit&id={id} | 編集モード（既存データを読み込み） |
| 参照 | mode=view&id={id} | 参照モード（全項目読み取り専用） |

### 共通処理
1. 画面初期化時にモード判定
2. 編集・参照モードの場合、指定IDのデータを取得
3. 取得データをフォームに設定
4. 参照モードの場合、全項目を読み取り専用に設定

## 各項目の説明

### 1. 部門名
| 項目 | 値 |
|:--|:--|
| ラベル | 部門名 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 50 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 統括部門の名称を入力 |

#### バリデーション
- 必須チェック: 未入力の場合「部門名は必須です。」を表示
- 文字数チェック: 50文字を超える場合「部門名は50文字以内で入力してください。」を表示
- 重複チェック: 同一部門名が存在する場合「この部門名は既に登録されています。」を表示

### 2. Field1
| 項目 | 値 |
|:--|:--|
| ラベル | Field1 |
| 型 | String |
| 必須 | ○ |
| 最大文字数 | 50 |
| 背景色 | #FFFFCC（必須項目） |
| 備考 | 追加フィールド1 |

#### バリデーション
- 必須チェック: 未入力の場合「Field1は必須です。」を表示
- 文字数チェック: 50文字を超える場合「Field1は50文字以内で入力してください。」を表示

## 一時保存処理
### 一時保存ボタン
- バリデーションを実行せずにデータを保存
- 保存成功時: 「一時保存しました。」メッセージ表示
- 保存失敗時: エラーメッセージ表示

### 一時保存API
[1.統括部門API](./API/1.統括部門.md)の[createDivision](./API/1.統括部門.md#createdivisioninput)または[updateDivision](./API/1.統括部門.md#updatedivisioninput)ミューテーションを呼び出し

#### 新規作成時
```json
createDivision(
   input: {
      division_name: "営業部",
      field1: "営業"
   }
)
```

#### 編集時
```json
updateDivision(
   input: {
      id: 123,
      division_name: "営業部",
      field1: "営業"
   }
)
```

## 登録処理
### 登録ボタン
1. 全項目のバリデーション実行
2. バリデーションエラーがある場合: エラーメッセージ表示、処理終了
3. バリデーション成功時: 登録確認モーダル表示

### 登録確認モーダル
#### モーダル内容
- タイトル: "登録確認"
- メッセージ: "統括部門を登録しますか？"
- ボタン: [キャンセル] [登録実行]

#### 登録実行処理
1. API呼び出し（一時保存と同じAPI）
2. 登録成功時: 成功メッセージ表示、一覧画面に遷移
3. 登録失敗時: エラーメッセージ表示

## 各種チェック

### 1. 必須項目チェック
必須項目が未入力の場合、該当項目にエラーメッセージを表示

### 2. 文字数チェック
各項目の最大文字数を超える場合、エラーメッセージを表示

### 3. 重複チェック
部門名の重複チェック（新規作成時のみ）
- 同一部門名が存在する場合、エラーメッセージを表示
- 編集時は自身のデータを除外してチェック

### 4. 相関チェック
特になし（単純なマスタデータのため）

## 完了メッセージ

### 成功メッセージ
- 一時保存完了: "一時保存しました。"
- 登録完了: "統括部門を登録しました。"

### エラーメッセージ
- バリデーションエラー: 該当項目にエラーメッセージ表示
- API通信エラー: "データの保存に失敗しました。"
- 重複エラー: "この部門名は既に登録されています。"

## ナビゲーション

### 戻るボタン
- 一覧画面に戻る
- 未保存の変更がある場合: 確認ダイアログ表示

### キャンセルボタン
- 一覧画面に戻る
- 未保存の変更がある場合: 確認ダイアログ表示

## エラーハンドリング

### API エラー
- 通信エラー: "データの取得に失敗しました。"
- 認証エラー: "ログインが必要です。"
- 権限エラー: "この操作を実行する権限がありません。"

### バリデーションエラー
- 必須項目エラー: 該当項目の背景色を変更し、エラーメッセージ表示
- 文字数エラー: 該当項目にエラーメッセージ表示
- 重複エラー: 該当項目にエラーメッセージ表示

## データ取得処理

### 編集・参照モード時のデータ取得
[1.統括部門API](./API/1.統括部門.md)の[getDivisionById](./API/1.統括部門.md#getdivisionbyidパラメータ)クエリを使用

#### リクエストパラメータ
```json
getDivisionById(
   request: {
      id: 123
   }
)
```
- id: 取得対象の統括部門ID

#### レスポンス処理
- 取得成功時: フォームにデータを設定
- 取得失敗時: エラーメッセージ表示、一覧画面に戻る
