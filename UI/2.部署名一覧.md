# 2.部署名一覧

## ワイヤーフレーム
```
┌─────────────────────────────────────────────────────────┐
│ 🏢 部署名一覧                      [🌙] [☀️]              │
├─────────────────────────────────────────────────────────┤
│ [🔍 検索条件] [▼]                                      │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 統括部門: [営業部 ▼] 部署名: [____] [🔍検索]        │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ [➕新規作成]                                          │
├─────────────────────────────────────────────────────────┤
│ No │ 部署ID │ 部署名      │ 統括部門 │ 操作              │
│────┼────────┼─────────────┼─────────┼───────────────────│
│ 1  │ D001   │ 営業第一課   │ 営業部   │ [👁️] [✏️] [🗑️]  │
│ 2  │ D002   │ 営業第二課   │ 営業部   │ [👁️] [✏️] [🗑️]  │
│ 3  │ D003   │ 製造第一課   │ 製造部   │ [👁️] [✏️] [🗑️]  │
├─────────────────────────────────────────────────────────┤
│ ページ: [◀️] 1/5 [▶️] 件数: 50件/全250件              │
└─────────────────────────────────────────────────────────┘
```

## 概要
部署名（Department）の一覧表示・管理画面。部署の検索、新規作成、編集、削除、CSV出力機能を提供する。統括部門による絞り込み検索が可能。

## エンドポイント
`/departments`

## 画面背景色
「ライトモード」及び「ダークモード」をボタン切替できるようにする

## 検索条件のデフォルト設定
- 検索条件は初期状態で全て空欄とする

## 1. 検索条件
検索条件パネルは初期状態で折りたたまれている。検索ボタン押下時に展開する。

### 検索項目
| 項目名 | 型 | 必須 | 備考 |
|:--|:--|:--|:--|
| 統括部門 | String | | 統括部門による絞り込み（完全一致） |
| 部署名 | String | | 部署名のあいまい検索（Like）を可能とする |

### 統括部門プルダウン
[1.統括部門API](./API/1.統括部門.md)の[getDivisions](./API/1.統括部門.md#getdivisionsパラメータ)クエリを使用して統括部門一覧を取得

#### リクエストパラメータ
```json
getDivisions(
   request: {
      page: 1,
      size: 1000
   }
)
```

#### プルダウン表示項目
| 表示値 | データソース | 備考 |
|:--|:--|:--|
| 選択してください | - | デフォルト選択肢 |
| 部門名 | division_name | 統括部門の名称 |

### 検索ボタン
- **検索ボタン**: 検索条件に基づいて部署一覧を取得
- **リセットボタン**: 検索条件をクリアして全件表示

## 2. 新規作成ボタン
[2.部署名入力](./2.部署名入力.md)に遷移（新規作成モード）


## 4. 一覧表示
[2.部署名API](./API/2.部署名.md)の[getDepartments](./API/2.部署名.md#getdepartmentsパラメータ)クエリを用いて検索結果を表示

### リクエストパラメータ
```json
getDepartments(
   request: {
      division_id: "...",
      department_name: "...",
      page: 1,
      size: 50
   }
)
```
- division_id: 検索条件の統括部門ID（完全一致）
- department_name: 検索条件の部署名（あいまい検索）
- page: ページ番号（1から開始）
- size: ページサイズ（固定値: 50）

### 一覧表示項目
| 項目名 | データソース | 備考 |
|:--|:--|:--|
| No | 連番 | 1から開始、ページ跨ぎで連続 |
| 部署ID | 自動生成ID | 部署ID（表示のみ、編集不可） |
| 部署名 | department_name | クリックで詳細表示可能 |
| 統括部門 | 関連する統括部門名 | 統括部門の名称を表示 |
| 操作 | - | 表示・編集・削除ボタン |

### 操作ボタン
| ボタン | 動作 | 備考 |
|:--|:--|:--|
| 表示 | [2.部署名入力](./2.部署名入力.md)（参照モード） | 編集不可 |
| 編集 | [2.部署名入力](./2.部署名入力.md)（編集モード） | 編集可能 |
| 削除 | 削除確認モーダル表示 | 確認後に削除実行 |

## 5. 削除処理
### 削除確認モーダル
削除ボタン押下時に確認モーダルを表示

#### モーダル内容
- タイトル: "削除確認"
- メッセージ: "選択された部署を削除しますか？"
- ボタン: [キャンセル] [削除実行]

#### 削除実行処理
1. [2.部署名API](./API/2.部署名.md)の[deleteDepartment](./API/2.部署名.md#deletedepartmentinput)ミューテーションを呼び出し
2. 削除成功時: 一覧を再読み込み、成功メッセージ表示
3. 削除失敗時: エラーメッセージ表示

### リクエストパラメータ
```json
deleteDepartment(
   input: {
      id: 123
   }
)
```
- id: 削除対象の部署ID

## 6. ページング
### ページング情報表示
- 現在ページ番号 / 総ページ数
- 表示件数 / 総件数
- 前へ・次へボタン

### ページング処理
- ページサイズ: 50件固定
- ページ番号: 1から開始
- ページ変更時: 検索条件を維持してAPI再呼び出し

## 7. エラーハンドリング
### API エラー
- 通信エラー: "データの取得に失敗しました。"
- 認証エラー: "ログインが必要です。"
- 権限エラー: "この操作を実行する権限がありません。"

### バリデーションエラー
- 検索条件エラー: 該当項目にエラーメッセージ表示

## 8. 完了メッセージ
### 成功メッセージ
- 削除完了: "部署を削除しました。"

### エラーメッセージ
- 削除失敗: "削除に失敗しました。"

## 9. 統括部門プルダウンの更新
### 統括部門データの更新
統括部門が追加・編集・削除された場合、部署名一覧の統括部門プルダウンも自動更新する

### 更新タイミング
- 画面初期表示時
- 統括部門一覧から戻ってきた時
- 統括部門の追加・編集・削除が行われた時
