# 3. Qualification Allowance API
**Version:** v0.1  
**Last Updated:** 2025-10-25  
**Author:** Chinh  
**Reviewer:** [PM/Leader Name]  
**System:** HR Management System  

---

## Overview
API for managing qualification allowances (T_資格手当). Provides functionality to manage qualification types and their corresponding allowance amounts.

## Base URL
`/api/v1/qualifications/allowances`

## Authentication
Bearer Token required for all endpoints

## RESTful API Design Principles
- **Resource-based URLs**: Use nouns, not verbs
- **HTTP Methods**: GET, POST, PUT, DELETE, PATCH
- **Status Codes**: Proper HTTP status codes
- **Stateless**: Each request contains all necessary information
- **Cacheable**: GET requests are cacheable
- **Uniform Interface**: Consistent API design across all resources

## Data Models

### Qualification Allowance Entity
```json
{
  "qualificationId": "number",        // Qualification ID (Primary Key)
  "name": "string",                   // Name
  "grade": "string",                  // Grade
  "type": "string",                   // Type
  "amount": "number",                 // Amount
  "remarks": "string"                 // Remarks
}
```

## Endpoints

### 1. Get All Qualification Allowances
**GET** `/api/v1/qualifications/allowances`

#### Query Parameters
- `page` (optional): Page number (default: 1)
- `size` (optional): Page size (default: 20)
- `name` (optional): Filter by qualification name
- `type` (optional): Filter by qualification type

#### Response
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "remarks": "IT関連の基本資格"
    },
    {
      "qualificationId": 2,
      "name": "応用情報技術者",
      "grade": "応用",
      "type": "国家資格",
      "amount": 8000.00,
      "remarks": "IT関連の応用資格"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 50,
    "totalPages": 3
  }
}
```

### 2. Get Qualification Allowance by ID
**GET** `/api/v1/qualifications/allowances/{qualificationId}`

#### Path Parameters
- `qualificationId`: Qualification ID

#### Response
```json
{
  "data": {
    "qualificationId": 1,
    "name": "基本情報技術者",
    "grade": "基本",
    "type": "国家資格",
    "amount": 5000.00,
    "remarks": "IT関連の基本資格"
  }
}
```

### 3. Create Qualification Allowance
**POST** `/api/v1/qualifications/allowances`

#### Request Body
```json
{
  "name": "データベーススペシャリスト",
  "grade": "専門",
  "type": "国家資格",
  "amount": 10000.00,
  "remarks": "データベース専門資格"
}
```

#### Response
```json
{
  "success": true,
  "message": "Qualification allowance created successfully",
  "data": {
    "qualificationId": 3,
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### 4. Update Qualification Allowance
**PUT** `/api/v1/qualifications/allowances/{qualificationId}`

#### Path Parameters
- `qualificationId`: Qualification ID

#### Request Body
```json
{
  "name": "データベーススペシャリスト（更新）",
  "grade": "専門",
  "type": "国家資格",
  "amount": 12000.00,
  "remarks": "データベース専門資格（更新）"
}
```

#### Response
```json
{
  "success": true,
  "message": "Qualification allowance updated successfully",
  "data": {
    "qualificationId": 3,
    "updatedAt": "2024-01-15T11:00:00Z"
  }
}
```

### 5. Delete Qualification Allowance
**DELETE** `/api/v1/qualifications/allowances/{qualificationId}`

#### Path Parameters
- `qualificationId`: Qualification ID

#### Response
```json
{
  "success": true,
  "message": "Qualification allowance deleted successfully"
}
```

### 6. Search Qualification Allowances
**GET** `/api/v1/qualifications/allowances/search`

#### Query Parameters
- `keyword` (required): Search keyword
- `type` (optional): Filter by qualification type
- `grade` (optional): Filter by grade

#### Response
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "remarks": "IT関連の基本資格"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 25,
    "totalPages": 2
  }
}
```

## Error Responses

### 400 Bad Request
```json
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "Invalid input data",
  "details": [
    {
      "field": "name",
      "message": "Qualification name is required"
    }
  ]
}
```

### 404 Not Found
```json
{
  "success": false,
  "error": "NOT_FOUND",
  "message": "Qualification not found"
}
```

### 409 Conflict
```json
{
  "success": false,
  "error": "CONFLICT",
  "message": "This qualification allowance already exists"
}
```

### 500 Internal Server Error
```json
{
  "success": false,
  "error": "INTERNAL_ERROR",
  "message": "An unexpected error occurred"
}
```

## Business Rules

1. **Qualification Allowance**: Must be unique by name and grade combination
2. **Amount Validation**: Amount must be positive number
3. **Qualification Name**: Cannot be empty and maximum 100 characters
4. **Grade**: Must be one of: "基本", "応用", "専門"
5. **Type**: Must be one of: "国家資格", "民間資格"

## Database Constraints

- Primary Key: `資格ID`
- Unique constraint for name and grade combination
- Check constraint for amount validation
- Check constraint for enum values

## Usage Examples

### Get qualification allowances list
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token"
```

### Create new qualification allowance
```bash
curl -X POST "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "新資格",
    "grade": "基本",
    "type": "国家資格",
    "amount": 5000.00,
    "remarks": "新しい資格"
  }'
```

### Search qualification allowances
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances/search?keyword=情報技術" \
  -H "Authorization: Bearer your-token"
```

---

*This API documentation is part of the Employee Management System*
