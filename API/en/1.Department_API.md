# 2. Department API
**Version:** v0.1  
**Last Updated:** 2025-10-25  
**Author:** Chinh  
**Reviewer:** [PM/Leader Name]  
**System:** HR Management System  

---

## Overview
API for managing department data (T_部署名). Provides hierarchical department management functionality.

## Base URL
`/api/v1/departments`

## Authentication
Bearer Token required for all endpoints

## Data Models

### Department Entity
```json
{
  "departmentId": "string",      // Department ID (Primary Key)
  "divisionId": "number",        // Division ID (Foreign Key)
  "departmentName": "string"     // Department Name
}
```

## Endpoints

### 1. Get All Departments
**GET** `/api/v1/departments`

#### Query Parameters
- `departmentId` (optional): Department ID (exact match)
- `divisionId` (optional): Division ID (exact match)
- `departmentName` (optional): Department name (fuzzy search)
- `page` (optional): Page number (default: 1)
- `size` (optional): Page size (default: 20)

#### Response
```json
{
  "content": [
    {
      "departmentId": "DEPT001",
      "divisionId": 1,
      "departmentName": "Sales Department 1"
    },
    {
      "departmentId": "DEPT002",
      "divisionId": 1,
      "departmentName": "Sales Department 2"
    }
  ],
  "totalElements": 100,
  "totalPages": 10,
  "currentPage": 1
}
```

### 2. Get Department by ID
**GET** `/api/v1/departments/{departmentId}`

#### Path Parameters
- `departmentId`: Department ID

#### Response
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "Sales Department 1"
}
```

### 3. Create Department
**POST** `/api/v1/departments`

#### Request Body
```json
{
  "divisionId": 1,
  "departmentName": "Sales Department 1"
}
```

#### Response
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "Sales Department 1"
}
```

### 4. Update Department
**PUT** `/api/v1/departments/{departmentId}`

#### Path Parameters
- `departmentId`: Department ID

#### Request Body
```json
{
  "divisionId": 1,
  "departmentName": "Sales Planning Department"
}
```

#### Response
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "Sales Planning Department"
}
```

### 5. Delete Department
**DELETE** `/api/v1/departments/{departmentId}`

#### Path Parameters
- `departmentId`: Department ID

#### Response
```json
{
  "success": true
}
```

## Error Responses

### 400 Bad Request
```json
{
  "error": "Bad Request",
  "message": "Invalid request parameters",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### 404 Not Found
```json
{
  "error": "Not Found",
  "message": "Department not found",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### 500 Internal Server Error
```json
{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

## Business Rules

1. **Department ID**: Must be unique across all departments
2. **Division ID**: Must reference an existing supervising department
3. **Name Validation**: Department name cannot be empty
4. **Hierarchy Validation**: Department must belong to a valid division

## Database Constraints

- Primary Key: `部署ID`
- Foreign Key: `T_部署名.部門ID` → `T_統括部門.部門ID`
- Unique constraints for department IDs
- Check constraints for name validations

## Usage Examples

### Get all departments
```bash
curl -X GET "https://api.company.com/api/v1/departments" \
  -H "Authorization: Bearer your-token"
```

### Create a new department
```bash
curl -X POST "https://api.company.com/api/v1/departments" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "divisionId": 1,
    "departmentName": "Marketing Department"
  }'
```

---

*This API documentation is part of the Employee Management System*