# 1. Employee Master API

## Overview
API for managing employee master data (T_社員マスタ table). Provides CRUD operations for employee information including personal details, work information, and leave management.

## Base URL
`/api/v1/employees`

## Authentication
Bearer Token required for all endpoints

## RESTful API Design Principles
- **Resource-based URLs**: Use nouns, not verbs
- **HTTP Methods**: GET, POST, PUT, DELETE, PATCH
- **Status Codes**: Proper HTTP status codes
- **Stateless**: Each request contains all necessary information
- **Cacheable**: GET requests are cacheable
- **Uniform Interface**: Consistent API design across all resources

## Data Model

### Employee Entity
```json
{
  "employeeCode": "string",           // 社員コード (Primary Key)
  "divisionName": "string",           // 部門名
  "departmentName": "string",         // 部署名
  "fullName": "string",               // 氏名
  "kanaName": "string",               // かな氏名
  "gender": "string",                 // 性別
  "dateOfBirth": "date",              // 生年月日
  "hireDate": "date",                 // 入社年月日
  "seniorityBaseDate": "date",        // 入社基準日
  "resignationDate": "date",          // 退職年月日
  "postalCode1": "string",            // 郵便番号1
  "address1": "string",               // 住所1
  "buildingName1": "string",          // ビル名1
  "phone1": "string",                 // TEL1
  "mobilePhone": "string",            // TEL携帯用
  "postalCode2": "string",            // 郵便番号2
  "address2": "string",               // 住所2
  "phone2": "string",                 // TEL2
  "buildingName2": "string",          // ビル名2
  "weddingAnniversary": "date",       // 結婚記念日
  "seniorityBaseYear": "number",      // 入社基準年
  "annualLeaveGranted": "number",     // 今年度付与
  "annualLeaveCarriedOver": "number", // 前年度繰越
  "totalAnnualLeave": "number",       // 年休合計
  "annualLeaveUsed": "number",        // 取得日数
  "remainingLeave": "number",         // 残日数
  "summerVacation1": "date",          // 夏休み1
  "summerVacation5": "date",          // 夏休み5
  "remarks": "string"                 // 備考
}
```

## Endpoints

### 1. Get All Employees
**GET** `/api/v1/employees`

#### Query Parameters
- `page` (optional): Page number (default: 1)
- `size` (optional): Page size (default: 20)
- `divisionName` (optional): Filter by division name
- `departmentName` (optional): Filter by department name
- `isRetired` (optional): Filter by retirement status (true/false)
- `search` (optional): Search by name or employee code

#### Response
```json
{
  "data": [
    {
      "employeeCode": "EMP001",
      "divisionName": "営業部",
      "departmentName": "営業一課",
      "fullName": "田中太郎",
      "kanaName": "タナカタロウ",
      "gender": "男性",
      "dateOfBirth": "1990-05-15",
      "hireDate": "2015-04-01",
      "seniorityBaseDate": "2015-04-01",
      "resignationDate": null,
      "postalCode1": "100-0001",
      "address1": "東京都千代田区千代田",
      "buildingName1": "サンプルビル1F",
      "phone1": "03-1234-5678",
      "mobilePhone": "090-1234-5678",
      "postalCode2": "100-0002",
      "address2": "東京都千代田区丸の内",
      "phone2": "03-2345-6789",
      "buildingName2": "サンプルビル2F",
      "weddingAnniversary": "2018-06-15",
      "seniorityBaseYear": 2015,
      "annualLeaveGranted": 20.0,
      "annualLeaveCarriedOver": 5.0,
      "totalAnnualLeave": 25.0,
      "annualLeaveUsed": 10.0,
      "remainingLeave": 15.0,
      "summerVacation1": "2024-08-10",
      "summerVacation5": "2024-08-14",
      "remarks": "特記事項なし"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 100,
    "totalPages": 5
  }
}
```

### 2. Get Employee by Code
**GET** `/api/v1/employees/{employeeCode}`

#### Path Parameters
- `employeeCode`: Employee code

#### Response
```json
{
  "data": {
    "employeeCode": "EMP001",
    "divisionName": "営業部",
    "departmentName": "営業一課",
    "fullName": "田中太郎",
    "kanaName": "タナカタロウ",
    "gender": "男性",
    "dateOfBirth": "1990-05-15",
    "hireDate": "2015-04-01",
    "seniorityBaseDate": "2015-04-01",
    "resignationDate": null,
    "postalCode1": "100-0001",
    "address1": "東京都千代田区千代田",
    "buildingName1": "サンプルビル1F",
    "phone1": "03-1234-5678",
    "mobilePhone": "090-1234-5678",
    "postalCode2": "100-0002",
    "address2": "東京都千代田区丸の内",
    "phone2": "03-2345-6789",
    "buildingName2": "サンプルビル2F",
    "weddingAnniversary": "2018-06-15",
    "seniorityBaseYear": 2015,
    "annualLeaveGranted": 20.0,
    "annualLeaveCarriedOver": 5.0,
    "totalAnnualLeave": 25.0,
    "annualLeaveUsed": 10.0,
    "remainingLeave": 15.0,
    "summerVacation1": "2024-08-10",
    "summerVacation5": "2024-08-14",
    "remarks": "特記事項なし"
  }
}
```

### 3. Create Employee
**POST** `/api/v1/employees`

#### Request Body
```json
{
  "employeeCode": "EMP002",
  "divisionName": "営業部",
  "departmentName": "営業二課",
  "fullName": "佐藤花子",
  "kanaName": "サトウハナコ",
  "gender": "女性",
  "dateOfBirth": "1992-08-20",
  "hireDate": "2017-04-01",
  "seniorityBaseDate": "2017-04-01",
  "resignationDate": null,
  "postalCode1": "150-0001",
  "address1": "東京都渋谷区神宮前",
  "buildingName1": "サンプルマンション101",
  "phone1": "03-3456-7890",
  "mobilePhone": "090-2345-6789",
  "postalCode2": "",
  "address2": "",
  "phone2": "",
  "buildingName2": "",
  "weddingAnniversary": null,
  "seniorityBaseYear": 2017,
  "annualLeaveGranted": 18.0,
  "annualLeaveCarriedOver": 0.0,
  "totalAnnualLeave": 18.0,
  "annualLeaveUsed": 5.0,
  "remainingLeave": 13.0,
  "summerVacation1": null,
  "summerVacation5": null,
  "remarks": ""
}
```

#### Response
```json
{
  "success": true,
  "message": "Employee created successfully",
  "data": {
    "employeeCode": "EMP002",
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### 4. Update Employee
**PUT** `/api/v1/employees/{employeeCode}`

#### Path Parameters
- `employeeCode`: Employee code

#### Request Body
Same as Create Employee

#### Response
```json
{
  "success": true,
  "message": "Employee updated successfully",
  "data": {
    "employeeCode": "EMP002",
    "updatedAt": "2024-01-15T11:00:00Z"
  }
}
```

### 5. Delete Employee
**DELETE** `/api/v1/employees/{employeeCode}`

#### Path Parameters
- `employeeCode`: Employee code

#### Response
```json
{
  "success": true,
  "message": "Employee deleted successfully"
}
```

### 6. Get Employee Qualifications
**GET** `/api/v1/employees/{employeeCode}/qualifications`

#### Path Parameters
- `employeeCode`: Employee code

#### Response
```json
{
  "data": [
    {
      "qualificationId": 1,
      "qualificationName": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "isChecked": true,
      "certificateNumber": "FE2024001",
      "acquisitionDate": "2024-03-15",
      "qualificationTypeId": 1
    }
  ]
}
```

### 7. Get Employee Annual Leave Details
**GET** `/api/v1/employees/{employeeCode}/annual-leave`

#### Path Parameters
- `employeeCode`: Employee code

#### Query Parameters
- `year` (optional): Year filter (default: current year)

#### Response
```json
{
  "data": [
    {
      "id": 1,
      "leaveDate": "2024-01-15",
      "days": 1.0,
      "count": 1
    },
    {
      "id": 2,
      "leaveDate": "2024-02-20",
      "days": 0.5,
      "count": 2
    }
  ]
}
```

## Error Responses

### 400 Bad Request
```json
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "Invalid input data",
  "details": [
    {
      "field": "employeeCode",
      "message": "Employee code is required"
    }
  ]
}
```

### 404 Not Found
```json
{
  "success": false,
  "error": "NOT_FOUND",
  "message": "Employee not found"
}
```

### 500 Internal Server Error
```json
{
  "success": false,
  "error": "INTERNAL_ERROR",
  "message": "An unexpected error occurred"
}
```

## Business Rules

1. **Employee Code**: Must be unique and follow company format
2. **Date Validation**: 
   - Date of birth must be before hire date
   - Hire date must be before resignation date (if provided)
   - Seniority base date should be same as hire date for new employees
3. **Annual Leave Calculation**:
   - Total annual leave = Granted + Carried over
   - Remaining leave = Total - Used
4. **Address Validation**: Postal code format validation for Japanese addresses
5. **Phone Validation**: Japanese phone number format validation

## Database Constraints

- Primary Key: `社員コード`
- Foreign Key relationships with other tables
- Check constraints for date validations
- Unique constraints for employee codes

---

*This API documentation is part of the Employee Management System*
