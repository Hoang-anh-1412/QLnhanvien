# 3. API Chứng Chỉ (Phụ cấp)
**Phiên bản:** v0.1  
**Ngày cập nhật:** 2025-10-25  
**Người biên soạn:** Chính  
**Người kiểm duyệt:** [PM/Leader Name]  
**Hệ thống:** Quản lý Nhân sự  

---

## Tổng quan
API quản lý phụ cấp chứng chỉ (T_資格手当). Cung cấp chức năng quản lý các loại phụ cấp chứng chỉ và mức phụ cấp tương ứng.

## Base URL
`/api/v1/qualifications/allowances`

## Xác thực
Bearer Token bắt buộc cho tất cả các endpoint

## Mô hình dữ liệu

### Thực thể Phụ cấp Chứng chỉ
```json
{
  "qualificationId": "number",        // ID chứng chỉ (Khóa chính)
  "name": "string",                   // Tên
  "grade": "string",                  // Cấp độ
  "type": "string",                   // Loại
  "amount": "number",                 // Số tiền
  "remarks": "string"                 // Ghi chú
}
```

## Endpoints

### 1. Lấy tất cả Phụ cấp Chứng chỉ
**GET** `/api/v1/qualifications/allowances`

#### Tham số truy vấn
- `page` (tùy chọn): Số trang (mặc định: 1)
- `size` (tùy chọn): Kích thước trang (mặc định: 20)
- `name` (tùy chọn): Lọc theo tên chứng chỉ
- `type` (tùy chọn): Lọc theo loại chứng chỉ

#### Phản hồi
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "Kỹ sư Thông tin Cơ bản",
      "grade": "Cơ bản",
      "type": "Chứng chỉ Quốc gia",
      "amount": 5000.00,
      "remarks": "Chứng chỉ IT cơ bản"
    },
    {
      "qualificationId": 2,
      "name": "Kỹ sư Thông tin Ứng dụng",
      "grade": "Ứng dụng",
      "type": "Chứng chỉ Quốc gia",
      "amount": 8000.00,
      "remarks": "Chứng chỉ IT ứng dụng"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 50,
    "totalPages": 3
  }
}
```

### 2. Lấy Phụ cấp Chứng chỉ theo ID
**GET** `/api/v1/qualifications/allowances/{qualificationId}`

#### Tham số đường dẫn
- `qualificationId`: ID chứng chỉ

#### Phản hồi
```json
{
  "data": {
    "qualificationId": 1,
    "name": "Kỹ sư Thông tin Cơ bản",
    "grade": "Cơ bản",
    "type": "Chứng chỉ Quốc gia",
    "amount": 5000.00,
    "remarks": "Chứng chỉ IT cơ bản"
  }
}
```

### 3. Tạo Phụ cấp Chứng chỉ
**POST** `/api/v1/qualifications/allowances`

#### Nội dung yêu cầu
```json
{
  "name": "Chuyên gia Cơ sở Dữ liệu",
  "grade": "Chuyên môn",
  "type": "Chứng chỉ Quốc gia",
  "amount": 10000.00,
  "remarks": "Chứng chỉ chuyên môn cơ sở dữ liệu"
}
```

#### Phản hồi
```json
{
  "success": true,
  "message": "Phụ cấp chứng chỉ đã được tạo thành công",
  "data": {
    "qualificationId": 3,
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### 4. Cập nhật Phụ cấp Chứng chỉ
**PUT** `/api/v1/qualifications/allowances/{qualificationId}`

#### Tham số đường dẫn
- `qualificationId`: ID chứng chỉ

#### Nội dung yêu cầu
```json
{
  "name": "Chuyên gia Cơ sở Dữ liệu (Cập nhật)",
  "grade": "Chuyên môn",
  "type": "Chứng chỉ Quốc gia",
  "amount": 12000.00,
  "remarks": "Chứng chỉ chuyên môn cơ sở dữ liệu (Cập nhật)"
}
```

#### Phản hồi
```json
{
  "success": true,
  "message": "Phụ cấp chứng chỉ đã được cập nhật thành công",
  "data": {
    "qualificationId": 3,
    "updatedAt": "2024-01-15T11:00:00Z"
  }
}
```

### 5. Xóa Phụ cấp Chứng chỉ
**DELETE** `/api/v1/qualifications/allowances/{qualificationId}`

#### Tham số đường dẫn
- `qualificationId`: ID chứng chỉ

#### Phản hồi
```json
{
  "success": true,
  "message": "Phụ cấp chứng chỉ đã được xóa thành công"
}
```

### 6. Tìm kiếm Phụ cấp Chứng chỉ
**GET** `/api/v1/qualifications/allowances/search`

#### Tham số truy vấn
- `keyword` (bắt buộc): Từ khóa tìm kiếm
- `type` (tùy chọn): Lọc theo loại chứng chỉ
- `grade` (tùy chọn): Lọc theo cấp độ

#### Phản hồi
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "Kỹ sư Thông tin Cơ bản",
      "grade": "Cơ bản",
      "type": "Chứng chỉ Quốc gia",
      "amount": 5000.00,
      "remarks": "Chứng chỉ IT cơ bản"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 25,
    "totalPages": 2
  }
}
```

## Phản hồi lỗi

### 400 Bad Request
```json
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "Dữ liệu đầu vào không hợp lệ",
  "details": [
    {
      "field": "name",
      "message": "Tên chứng chỉ là bắt buộc"
    }
  ]
}
```

### 404 Not Found
```json
{
  "success": false,
  "error": "NOT_FOUND",
  "message": "Không tìm thấy chứng chỉ"
}
```

### 409 Conflict
```json
{
  "success": false,
  "error": "CONFLICT",
  "message": "Phụ cấp chứng chỉ này đã tồn tại"
}
```

### 500 Internal Server Error
```json
{
  "success": false,
  "error": "INTERNAL_ERROR",
  "message": "Đã xảy ra lỗi không mong muốn"
}
```

## Quy tắc nghiệp vụ

1. **Phụ cấp Chứng chỉ**: Phải duy nhất theo tổ hợp tên và cấp độ
2. **Xác thực Số tiền**: Số tiền phải là số dương
3. **Tên chứng chỉ**: Không được trống và tối đa 100 ký tự
4. **Cấp độ**: Phải là một trong các giá trị: "Cơ bản", "Ứng dụng", "Chuyên môn"
5. **Loại**: Phải là một trong các giá trị: "Chứng chỉ Quốc gia", "Chứng chỉ Tư nhân"

## Ràng buộc cơ sở dữ liệu

- Khóa chính: `資格ID`
- Ràng buộc duy nhất cho tổ hợp tên và cấp độ
- Ràng buộc kiểm tra cho xác thực số tiền
- Ràng buộc kiểm tra cho các giá trị enum

## Ví dụ sử dụng

### Lấy danh sách phụ cấp chứng chỉ
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token"
```

### Tạo phụ cấp chứng chỉ mới
```bash
curl -X POST "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Chứng chỉ mới",
    "grade": "Cơ bản",
    "type": "Chứng chỉ Quốc gia",
    "amount": 5000.00,
    "remarks": "Chứng chỉ mới"
  }'
```

### Tìm kiếm phụ cấp chứng chỉ
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances/search?keyword=kỹ thuật thông tin" \
  -H "Authorization: Bearer your-token"
```

---

*Tài liệu API này là một phần của Hệ thống Quản lý Nhân viên*