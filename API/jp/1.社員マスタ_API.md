# 1. 社員マスタ API

## 概要
社員マスタデータ（T_社員マスタテーブル）を管理するAPIです。個人情報、勤務情報、休暇管理を含む社員情報のCRUD操作を提供します。

## ベースURL
`/api/v1/employees`

## 認証
すべてのエンドポイントでBearer Tokenが必要です

## RESTful API設計原則
- **リソースベースURL**: 動詞ではなく名詞を使用
- **HTTPメソッド**: GET, POST, PUT, DELETE, PATCH
- **ステータスコード**: 適切なHTTPステータスコード
- **ステートレス**: 各リクエストに必要な情報をすべて含める
- **キャッシュ可能**: GETリクエストはキャッシュ可能
- **統一インターフェース**: すべてのリソースで一貫したAPI設計

## データモデル

### 社員エンティティ
```json
{
  "employeeCode": "string",           // 社員コード (主キー)
  "divisionName": "string",           // 部門名
  "departmentName": "string",         // 部署名
  "fullName": "string",               // 氏名
  "kanaName": "string",               // かな氏名
  "gender": "string",                 // 性別
  "dateOfBirth": "date",              // 生年月日
  "hireDate": "date",                 // 入社年月日
  "seniorityBaseDate": "date",        // 入社基準日
  "resignationDate": "date",          // 退職年月日
  "postalCode1": "string",            // 郵便番号1
  "address1": "string",               // 住所1
  "buildingName1": "string",          // ビル名1
  "phone1": "string",                 // TEL1
  "mobilePhone": "string",            // TEL携帯用
  "postalCode2": "string",            // 郵便番号2
  "address2": "string",               // 住所2
  "phone2": "string",                 // TEL2
  "buildingName2": "string",          // ビル名2
  "weddingAnniversary": "date",       // 結婚記念日
  "seniorityBaseYear": "number",      // 入社基準年
  "annualLeaveGranted": "number",     // 今年度付与
  "annualLeaveCarriedOver": "number", // 前年度繰越
  "totalAnnualLeave": "number",       // 年休合計
  "annualLeaveUsed": "number",        // 取得日数
  "remainingLeave": "number",         // 残日数
  "summerVacation1": "date",          // 夏休み1
  "summerVacation5": "date",          // 夏休み5
  "remarks": "string"                 // 備考
}
```

## エンドポイント

### 1. 全社員取得
**GET** `/api/v1/employees`

#### クエリパラメータ
- `page` (任意): ページ番号 (デフォルト: 1)
- `size` (任意): ページサイズ (デフォルト: 20)
- `divisionName` (任意): 部門名でフィルタ
- `departmentName` (任意): 部署名でフィルタ
- `isRetired` (任意): 退職状況でフィルタ (true/false)
- `search` (任意): 氏名または社員コードで検索

#### レスポンス
```json
{
  "data": [
    {
      "employeeCode": "EMP001",
      "divisionName": "営業部",
      "departmentName": "営業一課",
      "fullName": "田中太郎",
      "kanaName": "タナカタロウ",
      "gender": "男性",
      "dateOfBirth": "1990-05-15",
      "hireDate": "2015-04-01",
      "seniorityBaseDate": "2015-04-01",
      "resignationDate": null,
      "postalCode1": "100-0001",
      "address1": "東京都千代田区千代田",
      "buildingName1": "サンプルビル1F",
      "phone1": "03-1234-5678",
      "mobilePhone": "090-1234-5678",
      "postalCode2": "100-0002",
      "address2": "東京都千代田区丸の内",
      "phone2": "03-2345-6789",
      "buildingName2": "サンプルビル2F",
      "weddingAnniversary": "2018-06-15",
      "seniorityBaseYear": 2015,
      "annualLeaveGranted": 20.0,
      "annualLeaveCarriedOver": 5.0,
      "totalAnnualLeave": 25.0,
      "annualLeaveUsed": 10.0,
      "remainingLeave": 15.0,
      "summerVacation1": "2024-08-10",
      "summerVacation5": "2024-08-14",
      "remarks": "特記事項なし"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 100,
    "totalPages": 5
  }
}
```

### 2. 社員コードで社員取得
**GET** `/api/v1/employees/{employeeCode}`

#### パスパラメータ
- `employeeCode`: 社員コード

#### レスポンス
```json
{
  "data": {
    "employeeCode": "EMP001",
    "divisionName": "営業部",
    "departmentName": "営業一課",
    "fullName": "田中太郎",
    "kanaName": "タナカタロウ",
    "gender": "男性",
    "dateOfBirth": "1990-05-15",
    "hireDate": "2015-04-01",
    "seniorityBaseDate": "2015-04-01",
    "resignationDate": null,
    "postalCode1": "100-0001",
    "address1": "東京都千代田区千代田",
    "buildingName1": "サンプルビル1F",
    "phone1": "03-1234-5678",
    "mobilePhone": "090-1234-5678",
    "postalCode2": "100-0002",
    "address2": "東京都千代田区丸の内",
    "phone2": "03-2345-6789",
    "buildingName2": "サンプルビル2F",
    "weddingAnniversary": "2018-06-15",
    "seniorityBaseYear": 2015,
    "annualLeaveGranted": 20.0,
    "annualLeaveCarriedOver": 5.0,
    "totalAnnualLeave": 25.0,
    "annualLeaveUsed": 10.0,
    "remainingLeave": 15.0,
    "summerVacation1": "2024-08-10",
    "summerVacation5": "2024-08-14",
    "remarks": "特記事項なし"
  }
}
```

### 3. 社員作成
**POST** `/api/v1/employees`

#### リクエストボディ
```json
{
  "employeeCode": "EMP002",
  "divisionName": "営業部",
  "departmentName": "営業二課",
  "fullName": "佐藤花子",
  "kanaName": "サトウハナコ",
  "gender": "女性",
  "dateOfBirth": "1992-08-20",
  "hireDate": "2017-04-01",
  "seniorityBaseDate": "2017-04-01",
  "resignationDate": null,
  "postalCode1": "150-0001",
  "address1": "東京都渋谷区神宮前",
  "buildingName1": "サンプルマンション101",
  "phone1": "03-3456-7890",
  "mobilePhone": "090-2345-6789",
  "postalCode2": "",
  "address2": "",
  "phone2": "",
  "buildingName2": "",
  "weddingAnniversary": null,
  "seniorityBaseYear": 2017,
  "annualLeaveGranted": 18.0,
  "annualLeaveCarriedOver": 0.0,
  "totalAnnualLeave": 18.0,
  "annualLeaveUsed": 5.0,
  "remainingLeave": 13.0,
  "summerVacation1": null,
  "summerVacation5": null,
  "remarks": ""
}
```

#### レスポンス
```json
{
  "success": true,
  "message": "社員が正常に作成されました",
  "data": {
    "employeeCode": "EMP002",
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### 4. 社員更新
**PUT** `/api/v1/employees/{employeeCode}`

#### パスパラメータ
- `employeeCode`: 社員コード

#### リクエストボディ
社員作成と同じ

#### レスポンス
```json
{
  "success": true,
  "message": "社員が正常に更新されました",
  "data": {
    "employeeCode": "EMP002",
    "updatedAt": "2024-01-15T11:00:00Z"
  }
}
```

### 5. 社員削除
**DELETE** `/api/v1/employees/{employeeCode}`

#### パスパラメータ
- `employeeCode`: 社員コード

#### レスポンス
```json
{
  "success": true,
  "message": "社員が正常に削除されました"
}
```

### 6. 社員資格取得
**GET** `/api/v1/employees/{employeeCode}/qualifications`

#### パスパラメータ
- `employeeCode`: 社員コード

#### レスポンス
```json
{
  "data": [
    {
      "qualificationId": 1,
      "qualificationName": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "isChecked": true,
      "certificateNumber": "FE2024001",
      "acquisitionDate": "2024-03-15",
      "qualificationTypeId": 1
    }
  ]
}
```

### 7. 社員年休詳細取得
**GET** `/api/v1/employees/{employeeCode}/annual-leave`

#### パスパラメータ
- `employeeCode`: 社員コード

#### クエリパラメータ
- `year` (任意): 年フィルタ (デフォルト: 当年)

#### レスポンス
```json
{
  "data": [
    {
      "id": 1,
      "leaveDate": "2024-01-15",
      "days": 1.0,
      "count": 1
    },
    {
      "id": 2,
      "leaveDate": "2024-02-20",
      "days": 0.5,
      "count": 2
    }
  ]
}
```

## エラーレスポンス

### 400 Bad Request
```json
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "入力データが無効です",
  "details": [
    {
      "field": "employeeCode",
      "message": "社員コードは必須です"
    }
  ]
}
```

### 404 Not Found
```json
{
  "success": false,
  "error": "NOT_FOUND",
  "message": "社員が見つかりません"
}
```

### 500 Internal Server Error
```json
{
  "success": false,
  "error": "INTERNAL_ERROR",
  "message": "予期しないエラーが発生しました"
}
```

## ビジネスルール

1. **社員コード**: 一意で会社フォーマットに従う必要があります
2. **日付検証**: 
   - 生年月日は入社日より前である必要があります
   - 入社日は退職日より前である必要があります（提供された場合）
   - 入社基準日は新入社員の場合は入社日と同じである必要があります
3. **年休計算**:
   - 年休合計 = 付与 + 繰越
   - 残日数 = 合計 - 取得日数
4. **住所検証**: 日本の住所の郵便番号フォーマット検証
5. **電話番号検証**: 日本の電話番号フォーマット検証

## データベース制約

- 主キー: `社員コード`
- 他のテーブルとの外部キー関係
- 日付検証のチェック制約
- 社員コードの一意制約

---

*このAPIドキュメントは社員管理システムの一部です*
