# 3. 資格手当 API
**バージョン:** v0.1  
**最終更新日:** 2025-10-25  
**作成者:** Chinh  
**レビュー担当:** [PM/Leader Name]  
**システム:** 人事管理システム  

---

## 概要
資格手当（T_資格手当）を管理するAPIです。資格手当の種類と金額を管理する機能を提供します。

## ベースURL
`/api/v1/qualifications/allowances`

## 認証
すべてのエンドポイントでBearer Tokenが必要です

## データモデル

### 資格手当エンティティ
```json
{
  "qualificationId": "number",        // 資格ID (主キー)
  "name": "string",                   // 名称
  "grade": "string",                  // 等級
  "type": "string",                   // 種類
  "amount": "number",                 // 金額
  "remarks": "string"                 // 備考
}
```

## エンドポイント

### 1. 全資格手当取得
**GET** `/api/v1/qualifications/allowances`

#### クエリパラメータ
- `page` (任意): ページ番号 (デフォルト: 1)
- `size` (任意): ページサイズ (デフォルト: 20)
- `name` (任意): 資格名でフィルタ
- `type` (任意): 資格種別でフィルタ

#### レスポンス
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "remarks": "IT関連の基本資格"
    },
    {
      "qualificationId": 2,
      "name": "応用情報技術者",
      "grade": "応用",
      "type": "国家資格",
      "amount": 8000.00,
      "remarks": "IT関連の応用資格"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 50,
    "totalPages": 3
  }
}
```

### 2. 資格手当IDで取得
**GET** `/api/v1/qualifications/allowances/{qualificationId}`

#### パスパラメータ
- `qualificationId`: 資格ID

#### レスポンス
```json
{
  "data": {
    "qualificationId": 1,
    "name": "基本情報技術者",
    "grade": "基本",
    "type": "国家資格",
    "amount": 5000.00,
    "remarks": "IT関連の基本資格"
  }
}
```

### 3. 資格手当作成
**POST** `/api/v1/qualifications/allowances`

#### リクエストボディ
```json
{
  "name": "データベーススペシャリスト",
  "grade": "専門",
  "type": "国家資格",
  "amount": 10000.00,
  "remarks": "データベース専門資格"
}
```

#### レスポンス
```json
{
  "success": true,
  "message": "資格手当が正常に作成されました",
  "data": {
    "qualificationId": 3,
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### 4. 資格手当更新
**PUT** `/api/v1/qualifications/allowances/{qualificationId}`

#### パスパラメータ
- `qualificationId`: 資格ID

#### リクエストボディ
```json
{
  "name": "データベーススペシャリスト（更新）",
  "grade": "専門",
  "type": "国家資格",
  "amount": 12000.00,
  "remarks": "データベース専門資格（更新）"
}
```

#### レスポンス
```json
{
  "success": true,
  "message": "資格手当が正常に更新されました",
  "data": {
    "qualificationId": 3,
    "updatedAt": "2024-01-15T11:00:00Z"
  }
}
```

### 5. 資格手当削除
**DELETE** `/api/v1/qualifications/allowances/{qualificationId}`

#### パスパラメータ
- `qualificationId`: 資格ID

#### レスポンス
```json
{
  "success": true,
  "message": "資格手当が正常に削除されました"
}
```

### 6. 資格手当検索
**GET** `/api/v1/qualifications/allowances/search`

#### クエリパラメータ
- `keyword` (必須): 検索キーワード
- `type` (任意): 資格種別でフィルタ
- `grade` (任意): 等級でフィルタ

#### レスポンス
```json
{
  "data": [
    {
      "qualificationId": 1,
      "name": "基本情報技術者",
      "grade": "基本",
      "type": "国家資格",
      "amount": 5000.00,
      "remarks": "IT関連の基本資格"
    }
  ],
  "pagination": {
    "page": 1,
    "size": 20,
    "totalElements": 25,
    "totalPages": 2
  }
}
```

## エラーレスポンス

### 400 Bad Request
```json
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "入力データが無効です",
  "details": [
    {
      "field": "name",
      "message": "資格名は必須です"
    }
  ]
}
```

### 404 Not Found
```json
{
  "success": false,
  "error": "NOT_FOUND",
  "message": "資格が見つかりません"
}
```

### 409 Conflict
```json
{
  "success": false,
  "error": "CONFLICT",
  "message": "この資格手当は既に存在します"
}
```

### 500 Internal Server Error
```json
{
  "success": false,
  "error": "INTERNAL_ERROR",
  "message": "予期しないエラーが発生しました"
}
```

## ビジネスルール

1. **資格手当**: 名前と等級の組み合わせで一意である必要があります
2. **金額検証**: 金額は正の数である必要があります
3. **資格名**: 空欄不可、最大100文字
4. **等級**: "基本"、"応用"、"専門"のいずれかである必要があります
5. **種類**: "国家資格"、"民間資格"のいずれかである必要があります

## データベース制約

- 主キー: `資格ID`
- 名前と等級の組み合わせの一意制約
- 金額検証のチェック制約
- 列挙値のチェック制約

## 使用例

### 資格手当一覧取得
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token"
```

### 新しい資格手当作成
```bash
curl -X POST "https://api.company.com/api/v1/qualifications/allowances" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "新資格",
    "grade": "基本",
    "type": "国家資格",
    "amount": 5000.00,
    "remarks": "新しい資格"
  }'
```

### 資格手当検索
```bash
curl -X GET "https://api.company.com/api/v1/qualifications/allowances/search?keyword=情報技術" \
  -H "Authorization: Bearer your-token"
```

---

*このAPIドキュメントは社員管理システムの一部です*
