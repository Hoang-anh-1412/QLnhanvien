# 2. 部署名 API
**バージョン:** v0.1  
**最終更新日:** 2025-10-25  
**作成者:** Chinh  
**レビュー担当:** [PM/Leader Name]  
**システム:** 人事管理システム  

---

## 概要
部署名（T_部署名）データを管理するAPIです。階層的な部署管理機能を提供します。

## ベースURL
`/api/v1/departments`

## 認証
すべてのエンドポイントでBearer Tokenが必要です

## データモデル

### 部署エンティティ
```json
{
  "departmentId": "string",      // 部署ID (主キー)
  "divisionId": "number",        // 部門ID (外部キー)
  "departmentName": "string"     // 部署名
}
```

## エンドポイント

### 1. 全部署取得
**GET** `/api/v1/departments`

#### クエリパラメータ
- `departmentId` (任意): 部署ID (完全一致検索)
- `divisionId` (任意): 部門ID (完全一致検索)
- `departmentName` (任意): 部署名 (あいまい検索)
- `page` (任意): ページ番号 (デフォルト: 1)
- `size` (任意): ページサイズ (デフォルト: 20)

#### レスポンス
```json
{
  "content": [
    {
      "departmentId": "DEPT001",
      "divisionId": 1,
      "departmentName": "営業一課"
    },
    {
      "departmentId": "DEPT002",
      "divisionId": 1,
      "departmentName": "営業二課"
    }
  ],
  "totalElements": 100,
  "totalPages": 10,
  "currentPage": 1
}
```

### 2. 部署IDで取得
**GET** `/api/v1/departments/{departmentId}`

#### パスパラメータ
- `departmentId`: 部署ID

#### レスポンス
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "営業一課"
}
```

### 3. 部署作成
**POST** `/api/v1/departments`

#### リクエストボディ
```json
{
  "divisionId": 1,
  "departmentName": "営業一課"
}
```

#### レスポンス
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "営業一課"
}
```

### 4. 部署更新
**PUT** `/api/v1/departments/{departmentId}`

#### パスパラメータ
- `departmentId`: 部署ID

#### リクエストボディ
```json
{
  "divisionId": 1,
  "departmentName": "営業企画課"
}
```

#### レスポンス
```json
{
  "departmentId": "DEPT001",
  "divisionId": 1,
  "departmentName": "営業企画課"
}
```

### 5. 部署削除
**DELETE** `/api/v1/departments/{departmentId}`

#### パスパラメータ
- `departmentId`: 部署ID

#### レスポンス
```json
{
  "success": true
}
```

## エラーレスポンス

### 400 Bad Request
```json
{
  "error": "Bad Request",
  "message": "Invalid request parameters",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### 404 Not Found
```json
{
  "error": "Not Found",
  "message": "Department not found",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### 500 Internal Server Error
```json
{
  "error": "Internal Server Error",
  "message": "An unexpected error occurred",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

## ビジネスルール

1. **部署ID**: すべての部署間で一意である必要があります
2. **部門ID**: 既存の統括部門を参照する必要があります
3. **名前検証**: 部署名は空にできません
4. **階層検証**: 部署は有効な部門に属している必要があります

## データベース制約

- 主キー: `部署ID`
- 外部キー: `T_部署名.部門ID` → `T_統括部門.部門ID`
- 部署IDの一意制約
- 名前検証のチェック制約

## 使用例

### 全部署を取得
```bash
curl -X GET "https://api.company.com/api/v1/departments" \
  -H "Authorization: Bearer your-token"
```

### 新しい部署を作成
```bash
curl -X POST "https://api.company.com/api/v1/departments" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "divisionId": 1,
    "departmentName": "マーケティング課"
  }'
```

---

*このAPIドキュメントは社員管理システムの一部です*
